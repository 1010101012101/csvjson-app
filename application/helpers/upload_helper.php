<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');// Upload helper/** * uploadFileIsValid * * @access	public * @param	string	filename being uploaded. Should be a key in $_FILES. * @param	string or NULL	Expected mime type. Optional when set to NULL. * @return	TRUE or string	TRUE if valid, or error message string upon failure. */if (!function_exists('uploadFileIsValid')) {	function uploadFileIsValid($filename, $expectedMime=NULL) {			if ($_FILES[$filename]['error'] !== UPLOAD_ERR_OK ||			!is_uploaded_file($_FILES[$filename]['tmp_name'])) {			return "Uplaod error: ".$_FILES[$filename]['error'];		}				if ($expectedMime) {			$mime = $this->getMimeType($_FILES[$filename]['tmp_name']);			if (!strpos($mime, $expectedMime) === 0)				return 'File upload '.$_FILES[$filename]['tmp_name']." invalid mime type: $mime. Expecting: $expectedMime";		}		return TRUE;	}}/** * getMimeType * * @access	public * @param	string	filename being uploaded. Should be a key in $_FILES. * @return	string	Mime type. */if (!function_exists('getMimeType')) {	function getMimeType($file) {		if (ENVIRONMENT == 'development') return 'text/plain';		$file = escapeshellarg($file);		$mime = shell_exec("file -bi " . $file);		return $mime;	}}/* End of file upload_helper.php *//* Location: ./application/helpers/upload_helper.php */